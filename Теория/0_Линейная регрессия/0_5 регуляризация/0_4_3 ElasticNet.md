## ElasticNet
ElasticNet - это [[0_4_1 L1 регуляризация (Lasso)|L1]] + [[0_4_2 L2 регуляризация (Ridge)|L2]] регуляция, то есть баланс между двумя регуляциями. Данный метод объединяет все полезные свойства обоих методов.

[[0_1_3_2 Формула ElasticNet|Формула:]]
$$
\min_w \left( L + \lambda \left( \alpha \sum |w_j| + (1 - \alpha) \sum w_j^2 \right) \right)
$$
Где: 
- a - коэффициент баланса L1 и L2 регуляции.
- min_w - найти такое w, при котором значение в скобках минимально.

### Что значит a 
коэффициент a - это показатель степени влияния каждой регуляции.  
Если: 
- ==a = 1==, то работает только L1 регуляция. Это происходит потому, что при подстановке 1 в формулу скобка (1 - a) зануляется и умножается на выражение L2 регуляции. По факту L2 просто умножается на ноль. 
- ==a = 0==, то работает только L2 регуляция. Срабатывает это по такому же принципу. 
- ==значение a лежит в интервале от 0 до 1==, модель работает с разной силой. Например, если a = 0.6, то L1 регуляция работает на 60 процентов, а L2 регуляция на 40 процентов.
### Плюсы ElasticNet
- ==Комбинирует полезные свойства== от L1 и L2 регуляции. 
- ==Стабильность==, работает лучше при сильной корреляции 
### Минусы ElasticNet 
- ==Медленнее==, чем L1 и L2
- ==Сложнее интерпретируется== 
### Пример вычисления ElasticNet
$$
\begin{aligned}
&\text{Дано:} \\
&i = 1, 2, 3 \\
&x = [1, 2, 3], \quad y = [2, 3, 5] \\
&\text{Модель:} \quad \hat{y}_i = w \cdot x_i \\
&\lambda = 1, \quad \alpha = 0.6 \\
\\
&\text{Функция для минимизации:} \\
&F(w) = \sum_{i=1}^3 (y_i - w x_i)^2 + \lambda \left( \alpha |w| + (1-\alpha) w^2 \right) \\
&= (2 - w)^2 + (3 - 2w)^2 + (5 - 3w)^2 + 0.6 |w| + 0.4 w^2 \\
\\
&\text{Пример расчёта при } w=1: \\
&E(w) = (2 - 1)^2 + (3 - 2)^2 + (5 - 3)^2 = 1 + 1 + 4 = 6 \\
&R(w) = 0.6 \times |1| + 0.4 \times 1^2 = 0.6 + 0.4 = 1.0 \\
&F(1) = 6 + 1 = 7 \\
\\
&\text{При } w=0.5: \\
&E(w) = (2 - 0.5)^2 + (3 - 1)^2 + (5 - 1.5)^2 = 2.25 + 4 + 12.25 = 18.5 \\
&R(w) = 0.6 \times 0.5 + 0.4 \times 0.5^2 = 0.3 + 0.1 = 0.4 \\
&F(0.5) = 18.5 + 0.4 = 18.9 \\
\\
&\text{При } w=2: \\
&E(w) = (2 - 2)^2 + (3 - 4)^2 + (5 - 6)^2 = 0 + 1 + 1 = 2 \\
&R(w) = 0.6 \times 2 + 0.4 \times 4 = 1.2 + 1.6 = 2.8 \\
&F(2) = 2 + 2.8 = 4.8 \\
\\
&\text{Минимум среди этих значений достигается при } w=2, \quad F(2) = 4.8
\end{aligned}
$$
